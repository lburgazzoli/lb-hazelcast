// *****************************************************************************
//
// *****************************************************************************

subprojects {
    apply plugin: 'java'
    apply plugin: 'groovy'
    apply plugin: 'maven'
    apply plugin: 'idea'
    apply plugin: 'osgi'

    version             = '1.0.0.SNAPSHOT'
    group               = 'com.github.lburgazzoli'
    sourceCompatibility = '1.8'
    targetCompatibility = '1.8'

    project.ext.versions = [
        slf4j              : '1.7.5',
        logback            : '1.1.2',
        log4j2             : '2.0-rc1',
        jackson            : '2.3.3',
        jacksonSmile       : '2.3.3',
        jacksonBson        : '2.3.1',
        hazelcast          : '3.2.1',
        guava              : '17.0',
        commonsLang        : '3.3.2',
        commonsCollections : '4.0',
        commonsPool        : '2.2',
        commonsIO          : '2.4',
        spring             : '4.0.4.RELEASE',
        springDataJpa      : '1.5.2.RELEASE',
        springReactor      : '1.1.0.RELEASE',
        springIntegration  : '4.0.0.RELEASE',
        hibernate          : '4.3.5.Final',
        hikaricp           : '1.3.8',
        hsqldb             : '2.3.2',
        netty              : '4.0.19.Final',
        junit              : '4.11',
        kryo               : '2.23.0',
        disruptor          : '3.2.1',
        groovy             : '2.3.0',
        gsCollections      : '5.0.0',
        groovy             : '2.3.0',
        jeromq             : '0.3.2',
        camel              : '2.12.3',
        batoo              : '2.0.1.3_1-SNAPSHOT',
        bonecp             : '0.8.0.RELEASE',
        openjpa            : '2.3.0',
        javassist          : '3.18.1-GA',
        openhftLang        : '6.3.5',
        openhftChronicle   : '3.0.1',
        openhftCollection  : '3.0.2',
        openhftAffinity    : '2.0.6',
        openhftCompiler    : '2.1.2',
        jsonpath           : '1.2'
    ]

    // *************************************************************************
    //
    // *************************************************************************

    idea {
        module {
            downloadJavadoc = true
            downloadSources = true
        }
    }

    // *************************************************************************
    //
    // *************************************************************************


    repositories {
        maven { url 'http://repo.springsource.org/release' }
        maven { url "http://repo.springsource.org/libs-milestone" }
        maven { url 'http://repository.springsource.com/maven/bundles/release' }
        maven { url 'http://repository.springsource.com/maven/bundles/external' }
        maven { url 'https://oss.sonatype.org/content/repositories/releases' }

        mavenLocal()
        mavenCentral()

        maven { url "https://oss.sonatype.org/content/repositories/snapshots" }
    }

    dependencies {
        compile "org.slf4j:slf4j-api:$versions.slf4j"
        compile "org.slf4j:slf4j-ext:$versions.slf4j"
        compile "org.slf4j:jul-to-slf4j:$versions.slf4j"
        compile "org.slf4j:jcl-over-slf4j:$versions.slf4j"

        compile "org.apache.logging.log4j:log4j-api:$versions.log4j2"
        compile "org.apache.logging.log4j:log4j-core:$versions.log4j2"
        compile "org.apache.logging.log4j:log4j-slf4j-impl:$versions.log4j2"

        compile "com.google.guava:guava:$versions.guava"
        compile "commons-io:commons-io:$versions.commonsIO"
        compile "org.apache.commons:commons-pool2:$versions.commonsPool"
        compile "org.apache.commons:commons-lang3:$versions.commonsLang"
        compile "org.apache.commons:commons-collections4:$versions.commonsCollections"
        compile "com.goldmansachs:gs-collections:$versions.gsCollections"

        compile "org.codehaus.groovy:groovy:$versions.groovy"
        compile "com.hazelcast:hazelcast-all:$versions.hazelcast"

        testCompile "junit:junit:$versions.junit"
    }

    test {
        testLogging {
            events          'failed'
            exceptionFormat 'full'
        }
    }

    [compileJava, compileTestJava]*.options*.compilerArgs = [
            "-Xlint:unchecked",
            "-Xlint:deprecation",
    ]

    // *************************************************************************
    //
    // *************************************************************************

    jar {
        baseName = "${project.name}"

        manifest.attributes['Bundle-Description'     ] = "lb :: ${project.name}"
        manifest.attributes['Bundle-Name'            ] = "lb :: ${project.name}"
        manifest.attributes['Bundle-SymbolicName'    ] = "${project.group}.${project.name}"
        manifest.attributes['Bundle-Version'         ] = project.version
        manifest.attributes['Implementation-Title'   ] = "${project.group}-${project.name}-${project.version}"
        manifest.attributes['Implementation-Version' ] = project.version
        manifest.attributes['Implementation-Vendor'  ] = 'lb'

        manifest.classesDir = new File("$buildDir/classes/main")
        manifest.classpath  = project.runtimeClasspath
    }
}

// *****************************************************************************
//
// *****************************************************************************

task wrapper(type: Wrapper) {
    gradleVersion = '1.11'
}
